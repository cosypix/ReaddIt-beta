document.getElementById('summarize').addEventListener('click', async ()=>{ const result=document.getElementById('result'); result.textContent='Summarizingâ€¦'; const [tab]= await chrome.tabs.query({active:true,currentWindow:true}); if(!tab?.url?.includes('reddit.com')){ result.textContent='Open a Reddit thread first.'; return;} try{ const res = await chrome.runtime.sendMessage({type:'SUMMARIZE_REDDIT', url: tab.url}); if(!res?.ok) throw new Error(res?.error||'Unknown error'); result.textContent = res.summary; } catch(e){ result.textContent = 'Error: '+ e.message; } });